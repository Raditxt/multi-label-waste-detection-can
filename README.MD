# ğŸ§  Multi-Label Trash Classifier

Klasifikasi **berbagai jenis sampah dalam satu gambar** menggunakan model CNN dan pendekatan multi-label classification. Proyek ini dirancang untuk mendeteksi **sampah campuran** (misalnya: plastik + kertas, logam + kaca) baik dari gambar statis maupun input webcam/IP camera secara real-time.

Dibangun sebagai bagian dari Proyek Akhir Semester D4 Teknik Komputer & Jaringan â€” Raditya Mulya Akbar, 2025.

## ğŸ¯ Tujuan Proyek

* âœ… Membangun sistem deteksi sampah otomatis berbasis citra.
* âœ… Mengakomodasi **multi-label classification** (1 gambar bisa mengandung banyak jenis sampah).
* âœ… Menyediakan antarmuka **web interaktif** untuk upload & prediksi.
* âœ… Mendukung prediksi **real-time dari webcam atau IP camera**, dengan **sumber video yang dapat diganti secara dinamis**.
* âœ… Menyediakan endpoint **REST API** untuk integrasi eksternal.

## ğŸ” Fitur Utama

* âœ… **Multi-label classification** dengan CNN + sigmoid activation
* âœ… Augmentasi & pelabelan campuran otomatis
* âœ… **Evaluasi model lengkap**: F1, AUC, confusion matrix, threshold optimasi
* âœ… **Web interface** berbasis Flask
* âœ… Deteksi **real-time** dari webcam, IP camera, atau file video
* âœ… **Ganti kamera secara dinamis** melalui antarmuka pengguna
* âœ… Endpoint REST API untuk klasifikasi berbasis gambar

## ğŸ§ª Teknologi & Tools

| Komponen | Teknologi / Library |
|----------|-------------------|
| Bahasa Pemrograman | Python 3.10+ |
| Deep Learning | TensorFlow / Keras |
| Evaluasi Model | Scikit-learn |
| Web Server | Flask |
| Real-Time Feed | OpenCV |
| Frontend Web | HTML, CSS, JS (Custom) |
| Visualisasi | Matplotlib, NumPy, Pandas |

## ğŸ§  Arsitektur Model

* Arsitektur: Custom CNN / Transfer Learning (ResNet/EfficientNet)
* Output: Sigmoid layer untuk prediksi multi-label
* Loss Function: Binary Cross-Entropy
* Dataset: Gabungan TrashNet + Kaggle Garbage Dataset, dikustomisasi
* Preprocessing: Augmentasi, Resize, Normalisasi, Multilabel Generator

## ğŸŒ Web Application Features

| Fitur | Status |
|-------|--------|
| Upload gambar & prediksi label | âœ… |
| Web interface (Flask) | âœ… |
| Deteksi real-time dari webcam | âœ… |
| Deteksi dari IP Camera | âœ… |
| Ganti sumber kamera secara live | âœ… |
| REST API: `/api/predict` | âœ… |
| Polling prediksi live (webcam) | âœ… |

## ğŸ§° Struktur Folder

```
sampah-multilabel-ai/
â”œâ”€â”€ dataset/                # Dataset, anotasi multi-label, checkpoints model
â”œâ”€â”€ notebook/               # Notebook preprocessing, training, evaluasi model
â”œâ”€â”€ venv_ai_clean/          # Virtual environment lokal (tidak disertakan)
â”œâ”€â”€ webapp/
â”‚   â”œâ”€â”€ app.py              # Aplikasi Flask utama
â”‚   â”œâ”€â”€ templates/          # HTML files (index.html, webcam.html)
â”‚   â”œâ”€â”€ static/             # JS, CSS, dan hasil upload
â”‚   â””â”€â”€ utils/              # predict.py, helper untuk model inference
```

## ğŸš€ Cara Menjalankan Aplikasi

1. **Aktifkan environment Python** (aktifkan `venv_ai_clean` atau gunakan `requirements.txt` jika tersedia)

2. **Jalankan Flask App**
   ```bash
   cd webapp
   python app.py
   ```

3. **Akses Web Interface**
   * Upload gambar: http://localhost:5000/
   * Webcam detection: http://localhost:5000/webcam

4. **Mengganti sumber kamera**
   * Gunakan formulir pada halaman `/webcam` untuk memasukkan:
     * `0` atau `1` â†’ webcam lokal
     * `http://192.168.x.x:8080/video` â†’ IP Camera (via IP Webcam Android)

## ğŸ“¦ Contoh Endpoint API

### ğŸ” Prediksi Gambar via API

```bash
POST /api/predict
Content-Type: multipart/form-data
Body: { image: <gambar.jpg> }
```

Response:
```json
{
  "detected_labels": {
    "plastic": 0.95,
    "paper": 0.88
  }
}
```

## ğŸ§  Hasil Evaluasi Model (ringkasan)

* F1-Score: 0.89 (rata-rata)
* AUC (macro): 0.93
* Akurasi multi-label: 86%
* Threshold optimal disesuaikan per-label

## ğŸ“Œ Catatan Tambahan

* Pastikan IP laptop dan IP Camera berada di jaringan yang sama.
* Model inference dilakukan per frame tiap 1 detik (untuk efisiensi).
* Gambar tangkapan webcam juga dapat diprediksi secara manual (snapshot).

## ğŸ“œ Lisensi

MIT Â© 2025 Raditya Mulya Akbar
Open for educational, research, and non-commercial use.